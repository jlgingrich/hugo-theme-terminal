{{ define "main" }}
<article class="author">
  <h1 class="author-title">
    <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
  </h1>
  <div class="author-meta">
    {{- if .Date -}}
    <time class="author-date">
      {{- partial "author-date" . -}}
      {{- if and $.Site.Params.showLastUpdated .Lastmod -}}
      &nbsp;{{- partial "author-lastmod" . -}}
      {{- end -}}
    </time>
    {{- end -}}
    {{- with .Params.Author -}}
    <a class="author-author" href="{{ (urlize (printf " authors/%s/" .)) | absLangURL }}">{{ . }}</a>
    {{- end -}}
    {{- if and (.Param "readingTime") (eq (.Param "readingTime") true) -}}
    <span class="author-reading-time">{{ .ReadingTime }} {{ $.Site.Params.minuteReadingTime | default "min read" }} ({{
      .WordCount }} {{ $.Site.Params.words | default "words" }})</span>
    {{- end -}}
  </div>

  {{ if .Params.tags }}
  <span class="author-tags">
    {{ range .Params.tags }}
    #<a href="{{ (urlize (printf " tags/%s/" .)) | absLangURL }}">{{ . }}</a>&nbsp;
    {{ end }}
  </span>
  {{ end }}
  {{ partial "cover.html" . }}

  {{ if (.Params.Toc | default .Site.Params.Toc) }}
  <div class="table-of-contents">
    <h2>
      {{ (.Params.TocTitle | default .Site.Params.TocTitle) | default "Table of Contents" }}
    </h2>
    {{ .TableOfContents }}
  </div>
  {{ end }}

  <div class="author-content">
    {{- with .Content -}}
    <div>
      {{ . | replaceRE "(<h[1-9] id=\"([^\"]+)\".+)(</h[1-9]+>)" `${1}<a href="#${2}" class="hanchor"
          ariaLabel="Anchor">#</a> ${3}` | safeHTML }}
    </div>
    {{- end -}}
  </div>

  {{ $isntDefault := not (or (eq (trim $.Site.Params.contentTypeName " ") "posts") (eq (trim
  $.Site.Params.contentTypeName " ") "")) }}
  {{ $contentTypeName := cond $isntDefault (string $.Site.Params.contentTypeName) "posts" }}

  {{ $posts := (where $.Site.RegularPages "Type" $contentTypeName)}}
  {{ $authorPosts := (where $posts "Params.Author" .Title )}}

  <br>
  {{ if ($authorPosts) }}
  <h2>Posts for: {{ .Title }}</h2>
  {{ end }}

  <div class="posts">

    {{ range $authorPosts }}

    <article class="post on-list">

      <h2 class="post-title">
        <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
      </h2>

      <div class="post-meta">
        {{- if .Date -}}
        <time class="post-date">
          {{- partial "post-date" . -}}
        </time>
        {{- end -}}
        {{- with .Params.Author -}}
        <a class="post-author" href="{{ (urlize (printf " authors/%s/" .)) | absLangURL }}">{{ . }}</a>
        {{- end -}}
      </div>

      {{ if .Params.tags }}
      <span class="post-tags">
        {{ range .Params.tags }}
        #<a href="{{ (urlize (printf " tags/%s/" . )) | absLangURL }}">
          {{- . -}}
        </a>&nbsp;
        {{ end }}
      </span>
      {{ end }}

      {{ partial "cover.html" . }}

      <div class="post-content">
        {{ if .Params.showFullContent }}
        {{ .Content }}
        {{ else if .Description }}
        <p>{{ .Description | markdownify }}</p>
        {{ else }}
        {{ .Summary }}
        {{ end }}
      </div>

      {{ if not .Params.showFullContent }}
      <div>
        <a class="read-more button inline" href="{{ .RelPermalink }}">[{{ $.Site.Params.ReadMore }}]</a>
      </div>
      {{ end }}
    </article>
    {{ end }}
  </div>


</article>
{{ end }}
