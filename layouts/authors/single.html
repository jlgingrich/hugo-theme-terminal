{{ define "main" }}
<article class="author">
  <h1 class="author-title">
    <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
    {{- /* Set defaults and get args. */}}
    {{- $address := .Params.Email }}

    {{- /* Get parts. */}}
    {{- $addressParts := split $address "@" }}
    {{- $userName := (index $addressParts 0) }}
    {{- $rootDomain := (index $addressParts 1) }}
    {{- $rootDomainParts := split $rootDomain "." }}
    {{- $domainName := (index $rootDomainParts 0) }}
    {{- $topLevelDomain := (index $rootDomainParts 1) }}

    {{- /* Render. */}}
    <span class="email">
      {{- printf "(%s@%s<b>.%s</b>.%s)" $userName $domainName $domainName $topLevelDomain | safeHTML -}}
    </span>
  </h1>

  {{ partial "cover.html" . }}

  <div class="author-content">
    {{- with .Content -}}
    <div>
      {{ . | replaceRE "(<h[1-9] id=\"([^\"]+)\".+)(</h[1-9]+>)" `${1}<a href="#${2}" class="hanchor"
          ariaLabel="Anchor">#</a> ${3}` | safeHTML }}
    </div>
    {{- end -}}
  </div>

  {{ $isntDefault := not (or (eq (trim $.Site.Params.contentTypeName " ") "posts") (eq (trim
  $.Site.Params.contentTypeName " ") "")) }}
  {{ $contentTypeName := cond $isntDefault (string $.Site.Params.contentTypeName) "posts" }}

  {{ $posts := (where $.Site.RegularPages "Type" $contentTypeName)}}
  {{ $authorPosts := (where $posts "Params.Author" .Title )}}

  <br>
  {{ if ($authorPosts) }}
  <h2>Posts for: {{ .Title }}</h2>
  {{ end }}

  <div class="posts">

    {{ range $authorPosts }}

    <article class="post on-list">

      <h2 class="post-title">
        <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
      </h2>

      <div class="post-meta">
        {{- if .Date -}}
        <time class="post-date">
          {{- partial "post-date" . -}}
        </time>
        {{- end -}}
        {{- with .Params.Author -}}
        <a class="post-author" href="{{ (urlize (printf " authors/%s/" .)) | absLangURL }}">{{ . }}</a>
        {{- end -}}
      </div>

      {{ if .Params.tags }}
      <span class="post-tags">
        {{ range .Params.tags }}
        #<a href="{{ (urlize (printf " tags/%s/" . )) | absLangURL }}">
          {{- . -}}
        </a>&nbsp;
        {{ end }}
      </span>
      {{ end }}

      {{ partial "cover.html" . }}

      <div class="post-content">
        {{ if .Params.showFullContent }}
        {{ .Content }}
        {{ else if .Description }}
        <p>{{ .Description | markdownify }}</p>
        {{ else }}
        {{ .Summary }}
        {{ end }}
      </div>

      {{ if not .Params.showFullContent }}
      <div>
        <a class="read-more button inline" href="{{ .RelPermalink }}">[{{ $.Site.Params.ReadMore }}]</a>
      </div>
      {{ end }}
    </article>
    {{ end }}
  </div>


</article>
{{ end }}